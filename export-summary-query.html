<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>NIHSS Summary</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #000; padding: 6px; vertical-align: top; }
    th { background-color: #f0f0f0; }
    .cortical { background-color: #eef; }
    .center { text-align: center; }
  </style>
</head>
<body>
  <h2>NIHSS 評估摘要</h2>
  <table>
    <tr><td><strong>姓名：</strong>______________</td><td><strong>年齡/性別：</strong>______________</td></tr>
    <tr><td><strong>病人編號：</strong>______________</td><td><strong>部門/床位：</strong>______________</td></tr>
  </table>

  <table id="summaryTable">
    <tr>
      <th>項目</th>
      <th>選項說明</th>
      <th>分數</th>
    </tr>
  </table>

  <script>
    const defs = {
      q1a: ["1a. 意識狀態", "0=清醒 1=嗜睡 2=遲鈍 3=昏迷"],
      q1b: ["1b. 基本問答", "0=全對 1=錯一 2=全錯"],
      q1c: ["1c. 指令執行", "0=兩項都對 1=一項對 2=皆錯"],
      q2: ["2. 眼球運動", "0=正常 1=部分偏移 2=強迫偏移"],
      q3: ["3. 視野", "0=正常 1=偏盲 2=完全偏盲 3=雙側偏盲"],
      q4: ["4. 面癱", "0=無 1=輕微 2=部分 3=完全"],
      q5a: ["5a. 左上肢", "0=不下垂 1=下垂未落床 2=落床 3=無力 4=無動作"],
      q5b: ["5b. 右上肢", "0=不下垂 1=下垂未落床 2=落床 3=無力 4=無動作"],
      q6a: ["6a. 左下肢", "0=不下垂 1=下垂未落床 2=落床 3=無力 4=無動作"],
      q6b: ["6b. 右下肢", "0=不下垂 1=下垂未落床 2=落床 3=無力 4=無動作"],
      q7: ["7. 小腦協調", "0=正常 1=一肢受損 2=兩肢受損"],
      q8: ["8. 感覺", "0=正常 1=輕度減退 2=重度減退"],
      q9: ["9. 語言", "0=正常 1=輕度失語 2=重度失語 3=無語"],
      q10: ["10. 說話不清", "0=清楚 1=稍不清楚 2=非常不清楚"],
      q11: ["11. 忽略", "0=無 1=單側忽略 2=雙側忽略"]
    };
    const cortical = ["q3", "q9", "q11"];
    const scores = Object.fromEntries(new URLSearchParams(location.search));
    let total = 0;
    const table = document.getElementById("summaryTable");
    for (const key in defs) {
      const val = scores[key] ?? "-";
      const num = parseInt(val);
      if (!isNaN(num)) total += num;
      const row = document.createElement("tr");
      if (cortical.includes(key)) row.classList.add("cortical");
      row.innerHTML = `<td>${defs[key][0]}</td><td>${defs[key][1]}</td><td class="center">${val}</td>`;
      table.appendChild(row);
    }
    const totalRow = document.createElement("tr");
    totalRow.innerHTML = `<th colspan="2">總分</th><th class="center">${total}</th>`;
    table.appendChild(totalRow);
  </script>
</body>
</html>